#!/usr/bin/env python3

import logging
import sys

from swh.loader.git import BulkLoader

ADDITIONAL_CONFIG = {
    'repo_path': ('str', None),

    'origin_url': ('str', 'file:///dev/null'),
    'authority': ('int', 1),
    'validity': ('str', '2015-01-01 00:00:00+00'),
}

logging.basicConfig(level=logging.INFO,
                    format='%(asctime)s %(name)s %(levelname)s %(message)s')

my_config = BulkLoader.parse_config_file(sys.argv[1], ADDITIONAL_CONFIG)

loader = BulkLoader(my_config)
loader.process(my_config['repo_path'],
               my_config['origin_url'],
               my_config['authority'],
               my_config['validity'])
